<!-- Altmetrics -->
<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>

<!-- Dimensions -->
<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<!-- Progressive Enhancement: Mark badge containers as ready after badges render -->
<script>
	(function(){
		const isBadgePopulated = (el) => {
			if (!el) return false;
			// Consider it populated if it has child nodes that render or non-zero dimensions
			return el.childElementCount > 0 || el.offsetWidth > 0;
		};

		const scan = () => {
			document.querySelectorAll('.badges-container').forEach(c => {
				if (c.classList.contains('badges-ready')) return; // skip if already marked
				const dim = c.querySelector('.__dimensions_badge_embed__');
				const alt = c.querySelector('.altmetric-embed');
				if (isBadgePopulated(dim) || isBadgePopulated(alt)) {
					c.classList.add('badges-ready');
				}
			});
		};

		// Repeated scans with backoff
		const schedule = [250, 600, 1200, 2000, 3500, 5000, 7000];
		schedule.forEach(t => setTimeout(scan, t));

		// Fallback: force all ready after 9s to avoid lingering placeholders
		setTimeout(() => {
			document.querySelectorAll('.badges-container:not(.badges-ready)').forEach(c => c.classList.add('badges-ready'));
		}, 9000);

		document.addEventListener('DOMContentLoaded', scan);
		window.addEventListener('load', scan);
	})();
</script>